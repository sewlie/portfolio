<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>3D Image Scrubber with Slider</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
html, body { height: 100%; margin: 0; }
body {
  background: #000;
  font-family: Arial, Helvetica, sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: #fff;
}

/* Image container */
#viewer {
  flex: 1;
  display: flex;
  align-items: center;    /* vertically center */
  justify-content: center; /* horizontally center */
  width: 100%;
  position: relative;
  overflow: hidden;
}

/* Main image */
#image {
  width: 100%;          /* maximize width */
  height: auto;         /* maintain aspect ratio */
  max-height: 100%;     /* don’t exceed viewport height */
  object-fit: contain;  /* scale properly */
  display: block;
  cursor: pointer;
}

/* Slider styling */
#slider {
  position: relative;
  z-index: 2; 
  width: 30vw; 
  margin: 20px 0;
  -webkit-appearance: none;
  appearance: none;
  height: 8px;
  background: #333;
  border-radius: 4px;
  outline: none;
}
#slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #fff;
  cursor: pointer;
  box-shadow: 0 0 5px rgba(255,255,255,0.8);
  transition: background 0.2s;
}
#slider::-webkit-slider-thumb:hover { background: #ff4444; }
#slider::-moz-range-thumb {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #fff;
  cursor: pointer;
  box-shadow: 0 0 5px rgba(255,255,255,0.8);
  transition: background 0.2s;
}
#slider::-moz-range-thumb:hover { background: #ff4444; }

/* Loading overlay */
#loadingOverlay {
  position: fixed;
  inset: 0;
  background: #000;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 1.5em;
  z-index: 999;
}
</style>
</head>
<body>

<div id="viewer">
  <img id="image" src="3d scan jpg/frame-07.jpg" alt="3D object frame" />
</div>

<input type="range" id="slider" min="1" max="36" step="1" value="7">

<div id="loadingOverlay">Loading 3D Object...</div>

<script>
const TOTAL_FRAMES = 36;
const FOLDER = "3d scan jpg";
const START_FRAME = 7;
const SCRUB_WIDTH = 0.75; // 75% of image width

const img = document.getElementById('image');
const slider = document.getElementById('slider');
const loadingOverlay = document.getElementById('loadingOverlay');
let currentFrame = START_FRAME;

// Preload all frames
let frames = [];
let loadedCount = 0;
for(let i=1;i<=TOTAL_FRAMES;i++){
  const frame = new Image();
  frame.src = `${FOLDER}/frame-${String(i).padStart(2,'0')}.jpg`;
  frame.onload = () => {
    loadedCount++;
    if (loadedCount === TOTAL_FRAMES) {
      loadingOverlay.style.display = "none";
    }
  };
  frames[i] = frame;
}

// Set initial frame
function updateImage(frame){
  img.src = frames[frame].src;
}
updateImage(START_FRAME);
slider.value = START_FRAME;

// --- Update frame helper ---
function setFrame(frame){
  frame = Math.min(Math.max(frame,1),TOTAL_FRAMES);

  // reverse frame mapping
  const reversedFrame = TOTAL_FRAMES - frame + 1;

  if(reversedFrame !== currentFrame){
    currentFrame = reversedFrame;
    updateImage(currentFrame);
    slider.value = frame; // slider goes normal 1 → TOTAL_FRAMES
  }
}

// --- Convert X to frame within narrow window ---
function getScrubFrame(clientX){
  const rect = img.getBoundingClientRect();
  const scrubWidth = rect.width * SCRUB_WIDTH;
  const scrubStart = rect.left + (rect.width - scrubWidth)/2; // center
  let ratio = (clientX - scrubStart) / scrubWidth;
  ratio = Math.min(Math.max(ratio, 0), 1);
  return Math.round(ratio * (TOTAL_FRAMES - 1)) + 1;
}

// --- Mouse support ---
img.addEventListener('mousemove', e => {
  setFrame(getScrubFrame(e.clientX));
});

// --- Touch support ---
img.addEventListener('touchstart', e => { 
  setFrame(getScrubFrame(e.touches[0].clientX)); 
  e.preventDefault(); 
});
img.addEventListener('touchmove', e => { 
  setFrame(getScrubFrame(e.touches[0].clientX)); 
  e.preventDefault(); 
});

// --- Slider support ---
slider.addEventListener('input', e => {
  setFrame(Number(e.target.value));
});
</script>

</body>
</html>
